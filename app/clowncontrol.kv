#:import Window kivy.core.window.Window
#:import dp kivy.metrics.dp

<LoginScreen>
    MDCard:
        size_hint: None, None
        size: 800, 700
        pos_hint: {'center_x':.5, 'center_y':.5}
        elevation: 10
        padding: 20, 20, 20, 20
        spacing: 20
        orientation: "vertical"

        MDLabel:
            text: "Anmeldung"
            font_size: "35sp"
            halign: "center"
            size_hint: 1, None
            height: self.texture_size[1]
            padding_y: 10

        MDTextField:
            id: username
            hint_text: "Username"
            icon_right: "account"
            size_hint: 0.8, None
            width: 600
            font_size: "15sp"
            pos_hint: {'center_x':.5}

        MDTextField:
            id: password
            hint_text: "Password"
            icon_right: "lock"
            size_hint: 0.8, None
            width: 600
            font_size: "15sp"
            pos_hint: {'center_x':.5}
            password: True

        MDRoundFlatButton:
            text: "Login"
            font_size: "15sp"
            size_hint: 0.8, None
            width: 400
            pos_hint: {'center_x':.5}
            on_press: root.validate_user()

        MDLabel
            id: error_label
            text: "Please Login"
            font_size: "15sp"
            valign: "top"
            halign: "center"
            size_hint: 0.8, None
            height: self.texture_size[1]
            pos_hint: {'center_x':.5}

<CreateTeamScreen>
    MDBoxLayout:
        id: layout_create_team
        orientation: "vertical"
        size_hint: 0.8, 0.8
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        spacing: 10
        MDScrollView:
            do_scroll_x: False
            MDGridLayout:
                id: layout_clowns_select
                cols: 1
                size_hint: 1, 1
                padding: 0, 10, 0, 10
                spacing: 10
                row_force_default: True
                row_default_height: 50
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        MDDropDownItem:
            id: dropdown_locations
            text: "Select Location"
            # font_size: "36sp"
            font_style: "H5"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            on_release: root.open_location_menu(self)
        Widget:
            size_hint: 1, None
            height: 10
        MDRoundFlatButton:
            text: "Create Team"
            # font_size: "36sp"
            font_style: "H6"
            size_hint: 0.8, None
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            on_press: root.create_team()


<ChatScreen>
    GridLayout:
        cols: 1
        size_hint: 1, 1
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        GridLayout:
            cols: 3
            padding: 20, 20, 20, 0
            spacing: 10
            size_hint: 1, None
            height: '48dp'
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            # logo of the app
            Image:
                source: 'icons/clown_control_icon.png'
                size_hint: 0.2, None
                size: 48, 48
                height: self.texture_size[1]
            # button to open chat
            MDRoundFlatButton:
                text: 'Open Chat'
                font_size: 36
                size_hint: 0.4, None
                height: '48dp'
                on_release: root.create_connection_service()
            MDRoundFlatButton:
                text: 'Logout'
                font_size: 36
                size_hint: 0.4, None
                height: '48dp'
                on_release: root.ask_for_logout()
        MDTabs:
            id: chat_tabs
            anchor_y: "bottom"
            on_tab_switch: root.on_tab_switch(*args)


<ChatTab>
    GridLayout:
        cols: 1
        size_hint: 1, 1
        pos_hint: {'center_x': 0.5, 'top': 1}
        MDScrollView:
            id: scroll_view
            do_scroll_x: False
            do_scroll_y: True
            size_hint: 1, 1

            BoxLayout:
                id: output
                orientation: 'vertical'
                size_hint_y: None
                height: self.minimum_height
                spacing: 10
        GridLayout:
            cols: 2
            size_hint: 1, None
            MDTextField:
                id: input
                font_size: 36
                padding: 20, 0, 0, 0
                font_name: 'fonts/seguiemj'
                multiline: False
                hint_text: 'Type your message here'
                input_type: 'text'
                keyboard_suggestions: True
                height: '48dp'
            MDIconButton:
                icon: 'send'
                # size_hint: 1, None
                height: '48dp'
                on_release: root.send_message()
        Widget:
            size_hint: 1, None
            height: '72dp'


<MessageBubble@AnchorLayout>:
    size_hint_y: None
    height: lbl.height + dp(10) if root.mode == 'info' else lbl.height
    anchor_x: 'left' if root.mode == 'incoming' else 'right' if root.mode == 'outgoing' else 'center'
    anchor_y: 'bottom'
    CustomLabel:
        id: lbl
        text: root.text
        font_name: 'fonts/seguiemj'
        font_size: '10sp' if root.mode == 'info' else '15sp'
        color: (1, 1, 1, 1) if root.mode == 'info' else (0, 0, 0, 1)
        size_hint: None, None
        height: self.texture_size[1]
        valign: 'middle'
        padding: 10
        canvas.before:
            Color:
                rgba: (0.62, 0.82, 1, 1) if root.mode == 'incoming' else (1, 0.69, 0.57, 1) if root.mode == 'outgoing' else (0.2, 0.2, 0.2, 1)
            RoundedRectangle:
                pos: self.pos
                size: self.size
                radius: [20]
